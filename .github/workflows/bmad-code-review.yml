name: BMAD Code Review (Central)
on:
  workflow_call:
    secrets:
      BMAD_CENTRAL_TOKEN:
        required: true
        description: "PAT with read access to the private mm-bmad repository"

jobs:
  code-review:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Caller Repository
        uses: actions/checkout@v4

      - name: Checkout Central Brain (mm-bmad)
        uses: actions/checkout@v4
        with:
          repository: jcampb/mm-bmad
          path: .mm-bmad
          token: ${{ secrets.BMAD_CENTRAL_TOKEN }}

      - name: Run GH-AW Code Review Agent
        uses: github/gh-aw@v1
        with:
          agent: .mm-bmad/agents/code-review.md
          github-token: ${{ secrets.GITHUB_TOKEN }}
